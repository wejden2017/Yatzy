private async getCloudEnvironment(url: URL): Promise<Environment> {
  let address = this.computeApiURL(url.toString()).toString();
  let pathApi = '/api/v1/environment-information';
  
  // ZQI 18 12 2025: fix URL in CLOUD environments contained a potentially malicious String "//"
  console.log(address);
  console.log(pathApi);
  
  if (address.endsWith('/')) {
    address = address.slice(0, -1);
  }
  
  const fullUrl = address + pathApi;
  console.log('üîç Calling:', fullUrl);
  
  try {
    const response = await this.http.get<{env: string}>(fullUrl).toPromise();
    return Environment[response.env];
  } catch (error) {
    console.error("Error when calling " + fullUrl, error);
    return Environment.PROD;
  }
}

private computeApiURL(location : string) : string {
  const url = new URL(location);
  
  // SPECIAL CASE OF LOCAL
  if (url.port === '4200') {
    url.port = '8080';
  }
  
  // SPECIAL CASE OF IUA2 EUA2
  url.pathname = EnvService.CATS2.test(url.pathname) ? 'cats2' : 'cats';
  url.hash = '';
  url.search = '';
  url.username = '';
  url.password = '';
  
  // ZQI 18 12 2025: Fix - Remove trailing slash to avoid "//" in URL
  let result = url.toString();
  if (result.endsWith('/')) {
    result = result.slice(0, -1);
  }
  
  return result;
}
