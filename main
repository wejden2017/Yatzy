resource "aws_lb_listener_rule" "apps_rules" {
  for_each = local.swagger_apps

  listener_arn = aws_lb_listener.main_tcp.arn
  priority     = 30 + index(keys(local.swagger_apps), each.key)

  action {
    type             = "forward"
    target_group_arn = aws_lb_target_group.tg_apps[each.key].arn
  }

  condition {
    path_pattern {
      values = ["/${each.key}", "/${each.key}/*"]
    }
  }
}
