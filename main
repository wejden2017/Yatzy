---
- name: "Test connexion WinRM"
  hosts: all
  gather_facts: no
  become: no  # IMPORTANT: Pas de sudo sur Windows
  vars:
    ansible_become: no
  tasks:
    - name: "Afficher un message simple"
      debug:
        msg: "SI VOUS VOYEZ CE MESSAGE, LE PLAYBOOK FONCTIONNE"
    
    - name: "Test de connectivité Windows"
      win_ping:
      register: ping_result
      
    - name: "Résultat du ping"
      debug:
        msg: "Ping réussi: {{ ping_result is succeeded }}"
        
    - name: "Test PowerShell simple"
      win_shell: "Get-Date"
      register: date_result
      
    - name: "Afficher la date"
      debug:
        var: date_result.stdout
