- name: Add Docker proxy config
  ansible.builtin.copy:
    src: http-proxy.conf     # <== doit être dans roles/docker_setup/files/
    dest: /etc/systemd/system/docker.service.d/http-proxy.conf
    mode: '0644'
  become: true

- name: Add override config
  ansible.builtin.copy:
    src: override.conf       # <== doit être dans roles/docker_setup/files/
    dest: /etc/systemd/system/docker.service.d/override.conf
    mode: '0644'
  become: true

- name: Reload systemd daemon
  ansible.builtin.systemd:
    daemon_reload: true
  become: true

- name: Restart Docker service
  ansible.builtin.service:
    name: docker
    state: restarted
  become: true

- name: Enable Docker service at boot
  ansible.builtin.service:
    name: docker
    enabled: true
  become: true
