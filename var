# 1) Debug (facultatif, mais utile une fois)
- name: Show cats_env and its type
  ansible.builtin.debug:
    msg: "cats_env={{ cats_env }} (type={{ cats_env | type_debug }})"
  tags: [config, update_database]

# 2) Normaliser cats_env -> string, lower, trim
- name: Normalize cats_env to a single string
  ansible.builtin.set_fact:
    cats_env: >-
      {{
        (
          cats_env
            if cats_env is string
            else (cats_env | first)        # si une liste a été passée
        ) | string | trim | lower
      }}
  tags: [config, update_database]
