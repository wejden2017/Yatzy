- name: EC2 Tools Lifecycle
  hosts: tools_servers
  become: true
  vars:
    ansible_python_interpreter: /usr/bin/python3
    do_install_docker: true
    do_install_mq: true

  pre_tasks:
    - name: Ensure SELinux Python bindings are present
      ansible.builtin.yum:
        name: libselinux-python
        state: present
      become: true

    - name: Recollect facts (force reinit of python bindings)
      ansible.builtin.setup:

  roles:
    - role: docker_setup
      when: do_install_docker

    - role: ibmmq
      when: do_install_mq and (docker_ready | default(false))
