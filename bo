archive_job:
  stage: archive
  script:
    - apt-get update && apt-get install -y tar
    - echo "üì¶ Cr√©ation de l'archive finale cats_${ARTIFACT_VERSION}.tar"
    
    # Cr√©ation du dossier dist s‚Äôil n‚Äôexiste pas
    - mkdir -p dist

    # Log de contr√¥le
    - echo "üìÇ Contenu du dossier build/${ARTIFACT_VERSION} :"
    - ls -al build/${ARTIFACT_VERSION} || echo "‚ùå build/${ARTIFACT_VERSION} introuvable"

    # Suppression ancienne archive si elle existe
    - rm -f dist/cats_${ARTIFACT_VERSION}.tar

    # Cr√©ation de l‚Äôarchive
    - tar -cvf dist/cats_${ARTIFACT_VERSION}.tar -C build/${ARTIFACT_VERSION} .

  dependencies:
    - package_job

  artifacts:
    paths:
      - dist/cats-${ARTIFACT_VERSION}.tar
    expire_in: 1 week
