-- 1) Voir les rôles actifs dans la session
SELECT * FROM session_roles ORDER BY role;

-- 2) Vérifier que QA_ROLE est bien actif
SELECT granted_role, default_role
FROM   dba_role_privs
WHERE  grantee = 'JEROME';

-- 3) Vérifier que QA_ROLE porte bien CREATE ANY TABLE
SELECT privilege
FROM   dba_sys_privs
WHERE  grantee = 'QA_ROLE'
ORDER  BY privilege;

-- 4) Vérifier que JEROME voit bien CREATE ANY TABLE via les rôles
SELECT DISTINCT privilege, admin_option
FROM   dba_sys_privs
WHERE  grantee IN (
  'JEROME',
  'QA_ROLE'
)
ORDER BY grantee, privilege;


SET ROLE QA_ROLE;


-- test simple de CREATE ANY TABLE dans LUCA
CREATE TABLE LUCA.ZZ_TEST_PRIV (ID NUMBER);


SELECT owner, trigger_name, trigger_type, triggering_event, table_owner, base_object_type
FROM   dba_triggers
WHERE  base_object_type = 'DATABASE'
ORDER  BY owner, trigger_name;

GRANT CREATE ANY TABLE TO JEROME;
