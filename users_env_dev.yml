# ============================================
# DEV Environment - User Management
# ============================================

default_password: "ChangeMe1234!"

users:
  - login: "zouertani"
    roles: ["DEV_ROLE"]
    action: "create"
    schemas: ["LUCA", "LUCA3"]

  - login: "dev_alice"
    roles: ["DEV_ROLE"]
    action: "create"
    schemas: ["LUCA", "LUCA1", "LUCA2"]

  - login: "toto"
    action: "delete"
```

---

### **`roles/oracle_user_admin/tasks/main.yml`**

*(Fichier dÃ©jÃ  fourni prÃ©cÃ©demment - version sans Docker)*

---

### **`roles/oracle_user_admin/templates/user_present.sql.j2`**

*(Fichier dÃ©jÃ  fourni prÃ©cÃ©demment)*

---

### **`roles/oracle_user_admin/templates/drop_user.sql.j2`**

*(Fichier dÃ©jÃ  fourni prÃ©cÃ©demment)*

---

### **`.gitignore`**
```
# Ansible
*.retry
.vault_pass
ssh_key.pem
vault-service.env
vault-secrets.env

# Python
__pycache__/
*.py[cod]
*$py.class
*.so
.Python

# Environments
.env
.venv
env/
venv/

# IDE
.idea/
.vscode/
*.swp
*.swo

# OS
.DS_Store
Thumbs.db

# Logs
*.log
/tmp/
README.md
markdown
# ğŸ—„ï¸ Oracle User Administration - CATS DB Admin

Gestion automatisÃ©e des utilisateurs Oracle via GitLab CI/CD et Ansible.

## ğŸ“‹ FonctionnalitÃ©s

- âœ… CrÃ©ation/Suppression d'utilisateurs
- âœ… Attribution de rÃ´les (DEV_ROLE, BA_ROLE, etc.)
- âœ… AccÃ¨s granulaire aux schÃ©mas
- âœ… Lock/Unlock de comptes
- âœ… Reset de mots de passe
- âœ… Multi-environnements (DEV, QA, UAT)
- âœ… Pipeline GitLab CI/CD automatique
- âœ… Authentification AWS + Vault

## ğŸ—ï¸ Architecture
```
GitLab Merge Request
         â†“
   Pipeline CI/CD
         â†“
   AWS Auth + Vault (rÃ©cupÃ©ration secrets)
         â†“
   Inventory dynamique (scan EC2)
         â†“
   Ansible Playbook
         â†“
   GÃ©nÃ©ration SQL
         â†“
   ExÃ©cution sur Oracle 19c Enterprise
```

## ğŸš€ Utilisation

### 1ï¸âƒ£ Ajouter un utilisateur

Modifier `env/users_env_dev.yml` :
```yaml
users:
  - login: "nouveau_dev"
    roles: ["DEV_ROLE"]
    action: "create"
    schemas: ["LUCA", "LUCA3"]
```

### 2ï¸âƒ£ Commit et Push
```bash
git checkout -b feature/add-user-nouveau-dev
git add env/users_env_dev.yml
git commit -m "feat: add nouveau_dev user"
git push origin feature/add-user-nouveau-dev
```

### 3ï¸âƒ£ CrÃ©er un Merge Request vers `dev`

- Pipeline de validation s'exÃ©cute automatiquement
- AprÃ¨s merge : pipeline d'application s'exÃ©cute automatiquement

## ğŸ“¦ PrÃ©requis

- EC2 avec Oracle 19c Enterprise
- Tag EC2 : `Role=CATS-DATABASE`
- Secrets dans Vault :
  - `EC2_KEY_PAIR`
  - `SYSDBA_PASSWORD`
  - `VAULT_PASSWORD`

## ğŸ”§ Configuration

Voir `inventory/common.yml` pour la configuration Oracle.

## ğŸ“ Support

Pour toute question, contactez l'Ã©quipe DevOps.

_____________________________________________________________________
âœ… Checklist finale
 Tous les fichiers crÃ©Ã©s
 inventory/aws_ec2_inventory.py exÃ©cutable (chmod +x)
 ORACLE_HOME correct dans common.yml
 Tags EC2 configurÃ©s : Role=CATS-DATABASE
 Secrets dans Vault (3 environnements)
 Branches GitLab : dev, qa, uat
VoilÃ  ! Votre projet est 100% prÃªt ! ğŸš€ğŸ’ª


