* ----------------------------------------------------------
* Fichier MQSC généré automatiquement par Ansible
* ----------------------------------------------------------

* 1) Désactiver la sécurité par tables de canaux + CONNAUTH
ALTER QMGR CHLAUTH(DISABLED)
ALTER QMGR CONNAUTH(' ')
REFRESH SECURITY TYPE(CONNAUTH)

* 2) Configurer le channel applicatif et forcer l’utilisateur MQ
ALTER CHANNEL('{{ mq_channel }}') CHLTYPE(SVRCONN) TRPTYPE(TCP) +
    MCAUSER('{{ mq_mcauser }}') REPLACE

* (optionnel, purement pour debug)
* DISPLAY CHANNEL('{{ mq_channel }}') MCAUSER

* 3) Donner tous les droits MQ à l’utilisateur applicatif
SET AUTHREC PROFILE('**') OBJTYPE(QMGR)  PRINCIPAL('{{ mq_mcauser }}') AUTHADD(ALL)
SET AUTHREC PROFILE('**') OBJTYPE(QUEUE) PRINCIPAL('{{ mq_mcauser }}') AUTHADD(ALL)

* 4) Rafraîchir le cache de sécu
REFRESH SECURITY TYPE(AUTHSERV)

* ----------------------------------------------------------
* Fin du fichier MQSC
* ----------------------------------------------------------
