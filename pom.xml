private sanitizeUrl(url: string): string {
  const parts = url.split('://');
  if (parts.length === 2) {
    return parts[0] + '://' + parts[1].replace(/\/+/g, '/');
  }
  return url.replace(/\/+/g, '/');
}

private getCloudEnvironment(url: URL): Environment {
  let address: string = this.computeApiURL(url.toString()).toString();
  const apiURL = new URL('/api/v1/environment-information', address);
  
  // Sanitize l'URL finale pour enlever tous les doubles slashes
  const sanitizedUrl = this.sanitizeUrl(apiURL.toString());
  
  console.log('URL FINALE:', sanitizedUrl);
  
  let request: XMLHttpRequest = new XMLHttpRequest();
  request.open('GET', sanitizedUrl, false); // `false` makes the request synchronous
  request.send();
  
  if (request.status === 200) {
    return Environment[JSON.parse(request.response).env];
  } else {
    console.error("Error when calling " + sanitizedUrl);
    return Environment.PROD;
  }
}

// Fonction helper pour sanitize les URLs
private sanitizeUrl(url: string): string {
  const parts = url.split('://');
  if (parts.length === 2) {
    return parts[0] + '://' + parts[1].replace(/\/+/g, '/');
  }
  return url.replace(/\/+/g, '/');
}
